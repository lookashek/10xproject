---
/**
 * Widok Generowania Fiszek AI
 *
 * Chroniony widok umożliwiający użytkownikom automatyczne tworzenie
 * fiszek edukacyjnych przy użyciu AI (OpenRouter.ai + Claude).
 *
 * Główne funkcjonalności:
 * - Formularz z textarea do wprowadzania tekstu źródłowego (1000-10000 znaków)
 * - Real-time walidacja długości tekstu z wizualnym licznikiem
 * - Generowanie propozycji fiszek przez AI z informacją o postępie
 * - Przeglądanie i edycja wygenerowanych propozycji
 * - Selekcja propozycji do zaakceptowania (domyślnie wszystkie zaznaczone)
 * - Zapis wybranych fiszek jako batch do bazy danych
 * - Obsługa błędów z informacyjnymi komunikatami dla użytkownika
 */

import Layout from "../layouts/Layout.astro";
import { GenerateView } from "../components/generate/GenerateView";
import { ToasterProvider } from "../components/ToasterProvider";

// TODO: Po wdrożeniu auth middleware
// const user = Astro.locals.user;
// if (!user) {
//   return Astro.redirect('/login');
// }

// Opcjonalnie: pobranie initialText z query params
const url = new URL(Astro.request.url);
const initialText = url.searchParams.get("text") || undefined;
---

<Layout title="Generuj fiszki - 10x cards">
  <GenerateView client:load initialText={initialText} />
  <ToasterProvider client:only="react" />
</Layout>
